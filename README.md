# ì¤‘ê³ ì„œì  ê±°ë˜ í”Œë«í¼ ì±…ë¹µ ğŸ“–ğŸ !
<p align="middle" style="margin: 0; padding: 0;">
  <img width="200px" src="./assets/image/5ven icon.png">
</p>

<p align="middle">
[í”Œë ˆì´ ë°ì´í„°] í•œí™”ì‹œìŠ¤í…œ BEYOND SWìº í”„
<br>ğŸ¥ªíŒ€ 5VEN
</p>

## ğŸ˜ƒ íŒ€ì› ì†Œê°œ

<figure>
    <table>
      <tr>
        <td align="center"><img src="./img/ìƒŒë“œìœ„ì¹˜.png" width="180px"/></td>
        <td align="center"><img src="./img/ì‹ë¹µ.png" width="180px"/></td>
        <td align="center"><img src="./img/ë°˜ì£½.png" width="180px"/></td>
	<td align="center"><img src="./img/ë°€ê°€ë£¨.png" width="180px"/></td>
        <td align="center"><img src="./img/ë°€.png" width="180px"/></td>
      </tr>
      <tr>
        <td align="center">íŒ€ì¥: <a href="https://github.com/daydeiday">ê³½íš¨ë¦¼</a></td>
        <td align="center">íŒ€ì›: <a href="https://github.com/wkdlrn">ê¹€ì¬êµ¬</a></td>
        <td align="center">íŒ€ì›: <a href="https://github.com/ChangeunLim" >ì„ì°¬ê·¼</a></td>
        <td align="center">íŒ€ì¥: <a href="https://github.com/InukChoi">ìµœì¸ìš±</a></td>
	<td align="center">íŒ€ì›: <a href="https://github.com/choi-won-ik" >ìµœì›ìµ</a></td>
      </tr>
    </table>
</figure>


## ğŸ“ í”„ë¡œì íŠ¸ ì†Œê°œ

> í˜„ëŒ€ì¸ë“¤ì€ ì±…ì„ í†µí•´ ì§€ì‹ì„ ì–»ê³  ê°ë™ì„ ê²½í—˜í•˜ì§€ë§Œ ë” ì´ìƒ í•„ìš”í•˜ì§€ ì•Šì€ ì±…ì´ ìŒ“ì—¬ê°€ëŠ” ë¬¸ì œë¥¼ ìì£¼ ê²ªìŠµë‹ˆë‹¤. **ì¤‘ê³ ì„œì  ê±°ë˜ í”Œë«í¼**ì€ ê°œì¸ê³¼ ê°œì¸(P2P) ë˜ëŠ” ê°œì¸ê³¼ ì—…ì ê°„ì˜ ì¤‘ê³  ì±… ê±°ë˜ë¥¼ ì†ì‰½ê²Œ ì—°ê²°í•˜ì—¬ ì±…ì˜ ê°€ì¹˜ë¥¼ ì§€ì†ì ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆëŠ” ê³µê°„ì„ ì œê³µí•©ë‹ˆë‹¤.



## ğŸ í”„ë¡œì íŠ¸ ê¸°íšì„œ
[í”„ë¡œì íŠ¸ ê¸°íšì„œ](https://github.com/beyond-sw-camp/be12-1st-5ven-bread_book/blob/kjg/assets/5%EC%A1%B0_%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8_%EA%B8%B0%ED%9A%8D%EC%84%9C_%EC%B5%9C%EC%A2%85.pdf)

## ğŸ“‚ ìš”êµ¬ì‚¬í•­ ì •ì˜ì„œ 
[ìš”êµ¬ì‚¬í•­ ì •ì˜ì„œ](https://github.com/beyond-sw-camp/be12-1st-5ven-bread_book/blob/kjg/assets/5%EC%A1%B0_%EC%9A%94%EA%B5%AC%EC%82%AC%ED%95%AD%20%EC%A0%95%EC%9D%98%EC%84%9C.pdf)
![ìš”êµ¬ì‚¬í•­ ì •ì˜ì„œ](https://raw.githubusercontent.com/beyond-sw-camp/be12-1st-5ven-bread_book/refs/heads/kjg/assets/image/%EC%9A%94%EA%B5%AC%EC%82%AC%ED%95%AD%20%EC%A0%95%EC%9D%98%EC%84%9C.png)
<br>

## âš™ï¸ ERD
![ERD](https://github.com/beyond-sw-camp/be12-1st-5ven-bread_book/blob/kjg/assets/image/5ven%20ERD.png?raw=true)
<br>

## ğŸ”€ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜
![ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](https://github.com/beyond-sw-camp/be12-1st-5ven-bread_book/blob/kjg/assets/image/sa.png?raw=true)
<br>
### ì„¤ê³„ ì˜ë„
- DB í´ëŸ¬ìŠ¤í„° (Active-Active)
  - ì±„íŒ… ê¸°ëŠ¥ ë“± ë¹„êµì  ì“°ê¸° ì‘ì—…ì´ ë§ì€ ì„œë¹„ìŠ¤ì¸ ë§Œí¼ ì—¬ëŸ¬ëŒ€ì˜ ì“°ê¸° ì„œë²„ êµ¬ì„±
  - ì¼ë¶€ ì„œë²„ ì¬ë‚œ ë°œìƒ ì‹œì—ë„ ê³„ì† ë¬¸ì œì—†ì´ ì‚¬ìš©í•˜ê¸° ì¢‹ìœ¼ë©° ì´í›„ ë™ê¸°í™”ë„ ë¹„êµì  ê°„ë‹¨í•œ êµ¬ì„±
  - ì´í›„ ì¶”ê°€ ì„œë²„ êµ¬ì„±ì´ í•„ìš”í•  ì‹œ ì„œë²„ ì¶”ê°€í•˜ê¸° ì‰¬ìš´ êµ¬ì¡°
- HAProxy
    - DB í´ëŸ¬ìŠ¤í„°ì˜ ë¶€í•˜ ë¶„ì‚°
    - SPOFì— ë”°ë¥¸ ë¬¸ì œë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ 2ëŒ€ë¥¼ êµ¬ì„±

## ğŸ” SQL íŒŒì¼ ë° ì„±ëŠ¥ ê°œì„ 
### 1. DDL íŒŒì¼

<details>
<summary>DDL</summary>
<div markdown="1">

- [ddl.sql](./assets/image/ddl.sql)

</div>
</details>

### 2. SQL íŒŒì¼



<details>
<summary>MEMBER</summary>
<div markdown="1">

- [member.sql](./assets/image/member.sql)

</div>
</details>

<details>
<summary>CHAT</summary>
<div markdown="1">

- [chat.sql](./assets/image/chatting.sql)

</div>
</details>


<details>
<summary>PRODUCT</summary>
<div markdown="1">

- [product.sql](./assets/image/product.sql)

</div>
</details>


<details>
<summary>PAY</summary>
<div markdown="1">

- [pay.sql](./assets/image/payment.sql)

</div>
</details>




### 3. SQL ì„±ëŠ¥ ê°œì„ 
- sql ì¿¼ë¦¬
  ```sql
  -- ì±„íŒ…ë°© ì¡°íšŒ(ê°œì„ ì „) ----
  SELECT 
      cr.id AS chat_room_id,       -- ì±„íŒ…ë°© ID
      cr.identifier AS book_title, -- ì±… ì œëª©
      b.id AS book_id,             -- ì±… ID
      p.id AS product_id,          -- íŒë§¤ ê²Œì‹œê¸€ ID
      p.member_id AS seller_id,    -- íŒë§¤ì ID
      cr.last_chat,                -- ë§ˆì§€ë§‰ ë©”ì‹œì§€
      cr.created_at                -- ìƒì„±ì¼ì‹œ
  FROM chatting_room cr
  JOIN product p ON cr.identifier = (
      SELECT b.title               -- ì±… ì œëª©ê³¼ identifier ë§¤ì¹­
      FROM book b 
      WHERE b.id = p.book_id
  )
  JOIN book b ON b.id = p.book_id  -- ì±… IDë¥¼ ì¶”ê°€ë¡œ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ ì¡°ì¸
  LIMIT 0, 1000;

  -- ì±„íŒ…ë°© ì¡°íšŒ(ê°œì„ í›„) ----
  SELECT 
      cr.id AS chat_room_id,       -- ì±„íŒ…ë°© ID
      b.title AS book_title,       -- ì±… ì œëª© (JOINì—ì„œ ê°€ì ¸ì˜´)
      b.id AS book_id,             -- ì±… ID
      p.id AS product_id,          -- íŒë§¤ ê²Œì‹œê¸€ ID
      p.member_id AS seller_id,    -- íŒë§¤ì ID
      cr.last_chat,                -- ë§ˆì§€ë§‰ ë©”ì‹œì§€
      cr.created_at                -- ìƒì„±ì¼ì‹œ
  FROM chatting_room cr
  JOIN book b ON cr.identifier = b.title  -- identifierì™€ title ë§¤ì¹­
  JOIN product p ON b.id = p.book_id  -- ì±… IDë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•œ ì¡°ì¸
  LIMIT 1000; -- LIMIT ë²”ìœ„ ì ìš©
  ```
- ì±„íŒ…ë°© ì¡°íšŒ ê¸°ëŠ¥ ì¿¼ë¦¬ ì„±ëŠ¥ ê°œì„ (ì„œë¸Œ ì¿¼ë¦¬ â†’ ë‹¤ì¤‘ ì¡°ì¸)
- set profilingì„ í†µí•´ ì¿¼ë¦¬ ì‹¤í–‰ì‹œê°„ ì¶•ì†Œ í™•ì¸
- grafanaë¥¼ í™œìš©í•œ ëª¨ë‹ˆí„°ë§ìœ¼ë¡œ ì¿¼ë¦¬ ì‹¤í–‰ì‹œ DB ì„œë²„ì˜ CPU ì‚¬ìš©ëŸ‰ ì¶•ì†Œ í™•ì¸
  
<p align="middle" style="margin: 0; padding: 0;">
  <img width="500px" src="./assets/image/5venì„±ëŠ¥ê°œì„ 1.png">
</p>
<p align="middle" style="margin: 0; padding: 0;">
  <img width="500px" src="./assets/image/5ven ì„±ëŠ¥ê°œì„  2.png">
</p>
<p align="middle">
  <strong>ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ì „/í›„ ë¹„êµ
</p>

## ğŸ® ê¸°ìˆ  ìŠ¤íƒ
&nbsp;&nbsp;&nbsp;&nbsp;<img src="https://img.shields.io/badge/GitHub-181717?style=flat&logo=GitHub&logoColor=white&color=black"></a>
&nbsp;&nbsp;&nbsp;&nbsp;<img src="https://img.shields.io/badge/Git-F05032?style=flat&logo=Git&logoColor=white&color=ffa500"></a>
&nbsp;&nbsp;&nbsp;&nbsp;<img src="https://img.shields.io/badge/MariaDB-003545?style=flat&logo=MariaDB&logoColor=white"></a>
&nbsp;&nbsp;&nbsp;&nbsp;<img src="https://img.shields.io/badge/Grafana-%23F46800.svg?style=flat&logo=grafana&logoColor=white"></a>
&nbsp;&nbsp;&nbsp;&nbsp;<img src="https://img.shields.io/badge/Prometheus-E6522C?style=flat&logo=Prometheus&logoColor=white"></a>
<br>